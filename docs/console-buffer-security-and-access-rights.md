---
title: Sicurezza dei buffer della console e diritti di accesso
description: Il modello di sicurezza di Windows consente di controllare l'accesso ai buffer di input della console e ai buffer dello schermo della console. Per ulteriori informazioni sulla sicurezza, vedere Access-Control Model.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, applicazioni in modalità carattere, applicazioni da riga di comando, applicazioni di terminale, api della console
MS-HAID:
- '\_win32\_console\_buffer\_security\_and\_access\_rights'
- base.console\_buffer\_security\_and\_access\_rights
- consoles.console\_buffer\_security\_and\_access\_rights
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: f9a50063-8fc8-4cd1-8f24-9ae3946d3119
ms.openlocfilehash: dfafdbd59c2b06929c35612d7dcf03b24439eba2
ms.sourcegitcommit: 463975e71920908a6bff9a6a7291ddf3736652d5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/30/2020
ms.locfileid: "93036979"
---
# <a name="console-buffer-security-and-access-rights"></a><span data-ttu-id="46045-105">Sicurezza dei buffer della console e diritti di accesso</span><span class="sxs-lookup"><span data-stu-id="46045-105">Console Buffer Security and Access Rights</span></span>

<span data-ttu-id="46045-106">Il modello di sicurezza di Windows consente di controllare l'accesso ai buffer di input della console e ai buffer dello schermo della console.</span><span class="sxs-lookup"><span data-stu-id="46045-106">The Windows security model enables you to control access to console input buffers and console screen buffers.</span></span> <span data-ttu-id="46045-107">Per altre informazioni sulla sicurezza, vedere [modello di controllo di accesso](https://msdn.microsoft.com/library/windows/desktop/aa374876).</span><span class="sxs-lookup"><span data-stu-id="46045-107">For more information about security, see [Access-Control Model](https://msdn.microsoft.com/library/windows/desktop/aa374876).</span></span>

## <a name="console-object-security-descriptors"></a><span data-ttu-id="46045-108">Descrittori di sicurezza oggetto console</span><span class="sxs-lookup"><span data-stu-id="46045-108">Console Object Security Descriptors</span></span>

<span data-ttu-id="46045-109">È possibile specificare un [descrittore di sicurezza](https://msdn.microsoft.com/library/windows/desktop/aa379563) per i buffer di input della console e dello schermo della console quando si chiama la funzione [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) o [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) .</span><span class="sxs-lookup"><span data-stu-id="46045-109">You can specify a [security descriptor](https://msdn.microsoft.com/library/windows/desktop/aa379563) for the console input and console screen buffers when you call the [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) or [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function.</span></span> <span data-ttu-id="46045-110">Se si specifica **null** , l'oggetto ottiene un descrittore di sicurezza predefinito.</span><span class="sxs-lookup"><span data-stu-id="46045-110">If you specify **NULL** , the object gets a default security descriptor.</span></span> <span data-ttu-id="46045-111">Gli ACL nel descrittore di sicurezza predefinito per un buffer della console provengono dal token primario o di rappresentazione del creatore.</span><span class="sxs-lookup"><span data-stu-id="46045-111">The ACLs in the default security descriptor for a console buffer come from the primary or impersonation token of the creator.</span></span>

<span data-ttu-id="46045-112">Gli handle restituiti da [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858), [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md)e [**GetStdHandle**](getstdhandle.md) dispongono dei diritti di accesso di **\_ lettura** e **\_ scrittura** generici.</span><span class="sxs-lookup"><span data-stu-id="46045-112">The handles returned by [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858), [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md), and [**GetStdHandle**](getstdhandle.md) have the **GENERIC\_READ** and **GENERIC\_WRITE** access rights.</span></span>

<span data-ttu-id="46045-113">I diritti di accesso validi includono i [diritti di accesso](https://msdn.microsoft.com/library/windows/desktop/aa446632)generico di **\_ lettura** e **\_ scrittura** generica.</span><span class="sxs-lookup"><span data-stu-id="46045-113">The valid access rights include the **GENERIC\_READ** and **GENERIC\_WRITE** [generic access rights](https://msdn.microsoft.com/library/windows/desktop/aa446632).</span></span>

| <span data-ttu-id="46045-114">Valore</span><span class="sxs-lookup"><span data-stu-id="46045-114">Value</span></span> | <span data-ttu-id="46045-115">Significato</span><span class="sxs-lookup"><span data-stu-id="46045-115">Meaning</span></span> |
|-|-|
| <span data-ttu-id="46045-116">**Generic \_ LETTURA** (0x80000000L)</span><span class="sxs-lookup"><span data-stu-id="46045-116">**GENERIC\_READ** (0x80000000L)</span></span>  | <span data-ttu-id="46045-117">Richiede l'accesso in lettura al buffer dello schermo della console, consentendo al processo di leggere i dati dal buffer.</span><span class="sxs-lookup"><span data-stu-id="46045-117">Requests read access to the console screen buffer, enabling the process to read data from the buffer.</span></span> |
| <span data-ttu-id="46045-118">**Generic \_ SCRITTURA** (0x40000000L)</span><span class="sxs-lookup"><span data-stu-id="46045-118">**GENERIC\_WRITE** (0x40000000L)</span></span> | <span data-ttu-id="46045-119">Richiede l'accesso in scrittura al buffer dello schermo della console, consentendo al processo di scrivere i dati nel buffer.</span><span class="sxs-lookup"><span data-stu-id="46045-119">Requests write access to the console screen buffer, enabling the process to write data to the buffer.</span></span> |

> [!NOTE]
> <span data-ttu-id="46045-120">**[Piattaforma UWP (Universal Windows Platform) le app console](https://docs.microsoft.com/windows/uwp/launch-resume/console-uwp)** e quelle con un **[livello di integrità](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control)** inferiore rispetto alla console collegata non saranno consentite sia per la lettura del buffer di output sia per la scrittura nel buffer di input anche se i descrittori di sicurezza sopra indicati normalmente lo consentiranno.</span><span class="sxs-lookup"><span data-stu-id="46045-120">**[Universal Windows Platform console apps](https://docs.microsoft.com/windows/uwp/launch-resume/console-uwp)** and those with a lower **[integrity level](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control)** than the attached console will be prohibited from both reading the output buffer and writing to the input buffer even if the security descriptors above would normally permit it.</span></span> <span data-ttu-id="46045-121">Per ulteriori informazioni, vedere la discussione dei **[verbi in modo errato](#wrong-way-verbs)** .</span><span class="sxs-lookup"><span data-stu-id="46045-121">Please see the **[Wrong Way Verbs](#wrong-way-verbs)** discussion below for more details.</span></span>

## <a name="wrong-way-verbs"></a><span data-ttu-id="46045-122">Verbi Wrong-Way</span><span class="sxs-lookup"><span data-stu-id="46045-122">Wrong-Way Verbs</span></span>

<span data-ttu-id="46045-123">Alcune operazioni sugli oggetti console verranno negate anche se l'oggetto dispone di un descrittore di sicurezza dichiarato per consentire in modo specifico la lettura o la scrittura.</span><span class="sxs-lookup"><span data-stu-id="46045-123">Some operations to the console objects will be denied even if the object has a security descriptor that is stated to specifically permit reading or writing.</span></span> <span data-ttu-id="46045-124">Questo riguarda specificamente le applicazioni da riga di comando in esecuzione in un contesto con privilegi ridotti che condividono una sessione della console creata da un'applicazione della riga di comando in un contesto più permissivo.</span><span class="sxs-lookup"><span data-stu-id="46045-124">This specifically concerns command-line applications running in a reduced-privilege context that are sharing a console session that was created by a command-line application in a more permissive context.</span></span>

<span data-ttu-id="46045-125">Il termine "verbi errati" deve essere applicato all'operazione che corrisponde al flusso normale per uno degli oggetti console.</span><span class="sxs-lookup"><span data-stu-id="46045-125">The term "wrong-way verbs" is intended to apply to the operation that is the converse of the normal flow for one of the console objects.</span></span> <span data-ttu-id="46045-126">In particolare, viene scritto il flusso normale per il buffer di output e viene letto il flusso normale per il buffer di input.</span><span class="sxs-lookup"><span data-stu-id="46045-126">Specifically, the normal flow for the output buffer is writing and the normal flow for the input buffer is reading.</span></span> <span data-ttu-id="46045-127">Il "errato" sarà quindi la lettura del buffer di output o la scrittura del buffer di input.</span><span class="sxs-lookup"><span data-stu-id="46045-127">The "wrong-way" would therefore be the reading of the output buffer or the writing of the input buffer.</span></span> <span data-ttu-id="46045-128">Si tratta di funzioni descritte nella documentazione sulle **[funzioni di i/O della console di basso livello](low-level-console-i-o.md)** .</span><span class="sxs-lookup"><span data-stu-id="46045-128">These are functions that are described in the **[Low-Level Console I/O Functions](low-level-console-i-o.md)** documentation.</span></span>

<span data-ttu-id="46045-129">I due scenari in cui è possibile trovare sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="46045-129">The two scenarios where this can be found are:</span></span>

1. <span data-ttu-id="46045-130">**[Piattaforma UWP (Universal Windows Platform) app console](https://docs.microsoft.com/windows/uwp/launch-resume/console-uwp)** .</span><span class="sxs-lookup"><span data-stu-id="46045-130">**[Universal Windows Platform console apps](https://docs.microsoft.com/windows/uwp/launch-resume/console-uwp)** .</span></span> <span data-ttu-id="46045-131">Poiché si tratta di cugini di altre applicazioni piattaforma UWP (Universal Windows Platform), gli utenti si aspettano che siano isolati da altre applicazioni e forniscano garanzie sugli effetti del loro funzionamento.</span><span class="sxs-lookup"><span data-stu-id="46045-131">As these are cousins of other Universal Windows Platform applications, they hold a promise that they are isolated from other applications and provide user guarantees around the effects of their operation.</span></span>
1. <span data-ttu-id="46045-132">Qualsiasi applicazione console avviata intenzionalmente con un **[livello di integrità](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control)** inferiore rispetto alla sessione esistente, che può essere eseguita con l' **[assegnazione di etichette o la manipolazione dei token durante CreateProcess](https://docs.microsoft.com/previous-versions/dotnet/articles/bb625960(v=msdn.10))** .</span><span class="sxs-lookup"><span data-stu-id="46045-132">Any console application intentionally launched with a lower **[integrity level](https://docs.microsoft.com/windows/win32/secauthz/mandatory-integrity-control)** than the existing session which can be accomplished with **[labeling or token manipulation during CreateProcess](https://docs.microsoft.com/previous-versions/dotnet/articles/bb625960(v=msdn.10))** .</span></span>

<span data-ttu-id="46045-133">Se viene rilevato uno di questi scenari, la console di applicherà il flag "verbi errati" alla connessione dell'applicazione della riga di comando e rifiuterà le chiamate alle API seguenti per ridurre la superficie di comunicazione tra i livelli:</span><span class="sxs-lookup"><span data-stu-id="46045-133">If either of these scenarios is detected, the console will apply the "wrong-way verbs" flag to the command-line application connection and reject calls to the following APIs to reduce the surface of communication between the levels:</span></span>

:::row:::
    :::column:::
        [<span data-ttu-id="46045-134">ReadConsoleOutput</span><span class="sxs-lookup"><span data-stu-id="46045-134">ReadConsoleOutput</span></span>](readconsoleoutput.md)  
        [<span data-ttu-id="46045-135">ReadConsoleOutputCharacter</span><span class="sxs-lookup"><span data-stu-id="46045-135">ReadConsoleOutputCharacter</span></span>](readconsoleoutputcharacter.md)  
        [<span data-ttu-id="46045-136">ReadConsoleOutputAttribute</span><span class="sxs-lookup"><span data-stu-id="46045-136">ReadConsoleOutputAttribute</span></span>](readconsoleoutputattribute.md)  
    :::column-end:::
    :::column:::
        [<span data-ttu-id="46045-137">WriteConsoleInput</span><span class="sxs-lookup"><span data-stu-id="46045-137">WriteConsoleInput</span></span>](writeconsoleinput.md)  
    :::column-end:::
:::row-end:::

<span data-ttu-id="46045-138">Le chiamate rifiutate riceveranno un codice di errore di **accesso negato** , come se l'autorizzazione di lettura o scrittura venisse negata dai descrittori di sicurezza per l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="46045-138">Rejected calls will receive an **access denied** error code, the same as if the read or write permission were denied by the security descriptors on the object.</span></span>
