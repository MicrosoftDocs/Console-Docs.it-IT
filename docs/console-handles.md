---
title: Handle della console
description: Un processo della console usa gli handle per accedere ai buffer di input e dello schermo della relativa console, incluse le funzioni GetStdHandle, CreateFile o CreateConsoleScreenBuffer.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, applicazioni in modalità carattere, applicazioni da riga di comando, applicazioni di terminale, api della console
MS-HAID:
- '\_win32\_console\_handles'
- base.console\_handles
- consoles.console\_handles
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: dc723046-b3e9-418a-b386-79be411e5ac8
ms.localizationpriority: high
ms.openlocfilehash: 817c902426ac09fdd246f8d1281528ee5dfcab06
ms.sourcegitcommit: 281eb1469f77ae4fb4c67806898e14eac440522a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 02/14/2021
ms.locfileid: "100358071"
---
# <a name="console-handles"></a><span data-ttu-id="7727a-104">Handle della console</span><span class="sxs-lookup"><span data-stu-id="7727a-104">Console Handles</span></span>

<span data-ttu-id="7727a-105">Un processo della console usa gli handle per accedere ai buffer di input e dello schermo della relativa console.</span><span class="sxs-lookup"><span data-stu-id="7727a-105">A console process uses handles to access the input and screen buffers of its console.</span></span> <span data-ttu-id="7727a-106">Un processo può usare la funzione [**GetStdHandle**](getstdhandle.md), [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) o [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) per aprire uno di questi handle.</span><span class="sxs-lookup"><span data-stu-id="7727a-106">A process can use the [**GetStdHandle**](getstdhandle.md), [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea), or [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function to open one of these handles.</span></span>

<span data-ttu-id="7727a-107">La funzione [**GetStdHandle**](getstdhandle.md) offre un meccanismo per recuperare gli handle di input standard (`STDIN`), di output standard (`STDOUT`) e di errore standard (`STDERR`) associati a un processo.</span><span class="sxs-lookup"><span data-stu-id="7727a-107">The [**GetStdHandle**](getstdhandle.md) function provides a mechanism for retrieving the standard input (`STDIN`), standard output (`STDOUT`), and standard error (`STDERR`) handles associated with a process.</span></span> <span data-ttu-id="7727a-108">Durante la creazione della console, il sistema crea questi handle.</span><span class="sxs-lookup"><span data-stu-id="7727a-108">During console creation, the system creates these handles.</span></span> <span data-ttu-id="7727a-109">Inizialmente, `STDIN` è un handle per il buffer di input della console e `STDOUT` e `STDERR` sono handle del buffer dello schermo attivo della console.</span><span class="sxs-lookup"><span data-stu-id="7727a-109">Initially, `STDIN` is a handle to the console's input buffer, and `STDOUT` and `STDERR` are handles of the console's active screen buffer.</span></span> <span data-ttu-id="7727a-110">Tuttavia, la funzione [**SetStdHandle**](setstdhandle.md) può reindirizzare gli handle standard modificando l'handle associato a `STDIN`, `STDOUT` o `STDERR`.</span><span class="sxs-lookup"><span data-stu-id="7727a-110">However, the [**SetStdHandle**](setstdhandle.md) function can redirect the standard handles by changing the handle associated with `STDIN`, `STDOUT`, or `STDERR`.</span></span> <span data-ttu-id="7727a-111">Poiché gli handle standard del padre vengono ereditati da qualsiasi processo figlio, le chiamate successive a **GetStdHandle** restituiscono l'handle reindirizzato.</span><span class="sxs-lookup"><span data-stu-id="7727a-111">Because the parent's standard handles are inherited by any child process, subsequent calls to **GetStdHandle** return the redirected handle.</span></span> <span data-ttu-id="7727a-112">Un handle restituito da **GetStdHandle** può pertanto fare riferimento a un elemento diverso dall'I/O della console.</span><span class="sxs-lookup"><span data-stu-id="7727a-112">A handle returned by **GetStdHandle** may, therefore, refer to something other than console I/O.</span></span> <span data-ttu-id="7727a-113">Prima di creare un processo figlio, ad esempio, un processo padre può usare **SetStdHandle** per impostare un handle di pipe in modo che sia l'handle `STDIN` ereditato dal processo figlio.</span><span class="sxs-lookup"><span data-stu-id="7727a-113">For example, before creating a child process, a parent process can use **SetStdHandle** to set a pipe handle to be the `STDIN` handle that is inherited by the child process.</span></span> <span data-ttu-id="7727a-114">Quando il processo figlio chiama **GetStdHandle**, ottiene l'handle di pipe.</span><span class="sxs-lookup"><span data-stu-id="7727a-114">When the child process calls **GetStdHandle**, it gets the pipe handle.</span></span> <span data-ttu-id="7727a-115">Questo significa che il processo padre può controllare gli handle standard del processo figlio.</span><span class="sxs-lookup"><span data-stu-id="7727a-115">This means that the parent process can control the standard handles of the child process.</span></span> <span data-ttu-id="7727a-116">Gli handle restituiti da **GetStdHandle** dispongono dell'accesso `GENERIC_READ | GENERIC_WRITE`, a meno che non sia stato usato **SetStdHandle** per impostare un livello di accesso inferiore per l'handle standard.</span><span class="sxs-lookup"><span data-stu-id="7727a-116">The handles returned by **GetStdHandle** have `GENERIC_READ | GENERIC_WRITE` access unless **SetStdHandle** has been used to set the standard handle to have lesser access.</span></span>

<span data-ttu-id="7727a-117">I valori degli handle restituiti da [**GetStdHandle**](getstdhandle.md) non sono 0, 1 e 2, pertanto le costanti di flusso predefinite standard in Stdio.h (`STDIN`, `STDOUT` e `STDERR`) non possono essere usate in funzioni che richiedono un handle della console.</span><span class="sxs-lookup"><span data-stu-id="7727a-117">The value of the handles returned by [**GetStdHandle**](getstdhandle.md) are not 0, 1, and 2, so the standard predefined stream constants in Stdio.h (`STDIN`, `STDOUT`, and `STDERR`) cannot be used in functions that require a console handle.</span></span>

<span data-ttu-id="7727a-118">La funzione [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) consente a un processo di ottenere un handle per il buffer di input e il buffer dello schermo attivo della relativa console, anche se `STDIN` e `STDOUT` sono stati reindirizzati.</span><span class="sxs-lookup"><span data-stu-id="7727a-118">The [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) function enables a process to get a handle to its console's input buffer and active screen buffer, even if `STDIN` and `STDOUT` have been redirected.</span></span> <span data-ttu-id="7727a-119">Per aprire un handle per il buffer di input di una console, specificare il valore `CONIN$` in una chiamata a **CreateFile**.</span><span class="sxs-lookup"><span data-stu-id="7727a-119">To open a handle to a console's input buffer, specify the `CONIN$` value in a call to **CreateFile**.</span></span> <span data-ttu-id="7727a-120">Per aprire un handle per il buffer dello schermo attivo di una console, specificare il valore `CONOUT$` in una chiamata a **CreateFile**.</span><span class="sxs-lookup"><span data-stu-id="7727a-120">Specify the `CONOUT$` value in a call to **CreateFile** to open a handle to a console's active screen buffer.</span></span> <span data-ttu-id="7727a-121">**CreateFile** consente di specificare l'accesso in lettura/scrittura dell'handle restituito.</span><span class="sxs-lookup"><span data-stu-id="7727a-121">**CreateFile** enables you to specify the read/write access of the handle that it returns.</span></span>

<span data-ttu-id="7727a-122">La funzione [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) crea un nuovo buffer dello schermo e restituisce un handle.</span><span class="sxs-lookup"><span data-stu-id="7727a-122">The [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function creates a new screen buffer and returns a handle.</span></span> <span data-ttu-id="7727a-123">Questo handle può essere usato in qualsiasi funzione che accetta un handle per l'output della console.</span><span class="sxs-lookup"><span data-stu-id="7727a-123">This handle can be used in any function that accepts a handle to console output.</span></span> <span data-ttu-id="7727a-124">Il nuovo buffer dello schermo non è attivo (visualizzato) fino a quando non viene specificato il relativo handle in una chiamata alla funzione [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md).</span><span class="sxs-lookup"><span data-stu-id="7727a-124">The new screen buffer is not active (displayed) until its handle is specified in a call to the [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) function.</span></span> <span data-ttu-id="7727a-125">Si noti che la modifica del buffer dello schermo attivo non influisce sull'handle restituito da [**GetStdHandle**](getstdhandle.md).</span><span class="sxs-lookup"><span data-stu-id="7727a-125">Note that changing the active screen buffer does not affect the handle returned by [**GetStdHandle**](getstdhandle.md).</span></span> <span data-ttu-id="7727a-126">Analogamente, l'uso di [**SetStdHandle**](setstdhandle.md) per modificare l'handle `STDOUT` non influisce sul buffer dello schermo attivo.</span><span class="sxs-lookup"><span data-stu-id="7727a-126">Similarly, using [**SetStdHandle**](setstdhandle.md) to change the `STDOUT` handle does not affect the active screen buffer.</span></span>

<span data-ttu-id="7727a-127">Gli handle della console restituiti da [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) e [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) possono essere usati in qualsiasi funzione della console che richiede un handle per il buffer di input o il buffer dello schermo di una console.</span><span class="sxs-lookup"><span data-stu-id="7727a-127">Console handles returned by [**CreateFile**](/windows/win32/api/fileapi/nf-fileapi-createfilea) and [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) can be used in any of the console functions that require a handle to a console's input buffer or of a console screen buffer.</span></span> <span data-ttu-id="7727a-128">Gli handle restituiti da [**GetStdHandle**](getstdhandle.md) possono essere utilizzati dalle funzioni della console se non sono stati reindirizzati per fare riferimento a elementi diversi dall'I/O della console.</span><span class="sxs-lookup"><span data-stu-id="7727a-128">Handles returned by [**GetStdHandle**](getstdhandle.md) can be used by the console functions if they have not been redirected to refer to something other than console I/O.</span></span> <span data-ttu-id="7727a-129">Se invece un handle standard è stato reindirizzato per fare riferimento a un file o a una pipe, può essere usato solo dalle funzioni [**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile) e [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile).</span><span class="sxs-lookup"><span data-stu-id="7727a-129">If a standard handle has been redirected to refer to a file or a pipe, however, the handle can only be used by the [**ReadFile**](/windows/win32/api/fileapi/nf-fileapi-readfile) and [**WriteFile**](/windows/win32/api/fileapi/nf-fileapi-writefile) functions.</span></span> <span data-ttu-id="7727a-130">[**GetFileType**](/windows/win32/api/fileapi/nf-fileapi-getfiletype) può essere utile per determinare il tipo di dispositivo a cui fa riferimento l'handle.</span><span class="sxs-lookup"><span data-stu-id="7727a-130">[**GetFileType**](/windows/win32/api/fileapi/nf-fileapi-getfiletype) can assist in determining what device type the handle refers to.</span></span> <span data-ttu-id="7727a-131">Un handle della console si presenta come `FILE_TYPE_CHAR`.</span><span class="sxs-lookup"><span data-stu-id="7727a-131">A console handle presents as `FILE_TYPE_CHAR`.</span></span>

<span data-ttu-id="7727a-132">Un processo può usare la funzione [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) per creare un handle della console duplicato con accesso o ereditarietà differente rispetto all'handle originale.</span><span class="sxs-lookup"><span data-stu-id="7727a-132">A process can use the [**DuplicateHandle**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) function to create a duplicate console handle that has different access or inheritability from the original handle.</span></span> <span data-ttu-id="7727a-133">Si noti, tuttavia, che un processo può creare un handle della console duplicato solo a proprio uso.</span><span class="sxs-lookup"><span data-stu-id="7727a-133">Note, however, that a process can create a duplicate console handle only for its own use.</span></span> <span data-ttu-id="7727a-134">Questo comportamento è diverso da quello degli altri tipi di handle, ad esempio file, pipe o oggetti mutex, per i quali **DuplicateHandle** può creare un duplicato valido per un processo diverso.</span><span class="sxs-lookup"><span data-stu-id="7727a-134">This differs from other handle types (such as file, pipe, or mutex objects), for which **DuplicateHandle** can create a duplicate that is valid for a different process.</span></span>
<span data-ttu-id="7727a-135">L'accesso a una console deve essere condiviso durante la [creazione](creation-of-a-console.md) dell'altro processo o può essere richiesto dall'altro processo tramite il meccanismo [**AttachConsole**](attachconsole.md).</span><span class="sxs-lookup"><span data-stu-id="7727a-135">Access to a console must be shared during [creation](creation-of-a-console.md) of the other process or may be requested by the other process through the [**AttachConsole**](attachconsole.md) mechanism.</span></span>

<span data-ttu-id="7727a-136">Per chiudere un handle della console, un processo può usare la funzione [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle).</span><span class="sxs-lookup"><span data-stu-id="7727a-136">To close a console handle, a process can use the [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) function.</span></span>