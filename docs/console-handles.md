---
title: Handle della console
description: Un processo della console usa gli handle per accedere ai buffer di input e dello schermo della relativa console, incluse le funzioni GetStdHandle, CreateFile o CreateConsoleScreenBuffer.
author: miniksa
ms.author: miniksa
ms.topic: conceptual
keywords: console, applicazioni in modalità carattere, applicazioni da riga di comando, applicazioni di terminale, api della console
MS-HAID:
- '\_win32\_console\_handles'
- base.console\_handles
- consoles.console\_handles
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
ms.assetid: dc723046-b3e9-418a-b386-79be411e5ac8
ms.localizationpriority: high
ms.openlocfilehash: acc7d65e15451fc2804dc1782644c1ccbaa30e28
ms.sourcegitcommit: 508e93bc83b4bca6ce678f88ab081d66b95d605c
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/01/2020
ms.locfileid: "96420240"
---
# <a name="console-handles"></a><span data-ttu-id="bc598-104">Handle della console</span><span class="sxs-lookup"><span data-stu-id="bc598-104">Console Handles</span></span>

<span data-ttu-id="bc598-105">Un processo console usa gli handle per accedere ai buffer di input e dello schermo della relativa console.</span><span class="sxs-lookup"><span data-stu-id="bc598-105">A console process uses handles to access the input and screen buffers of its console.</span></span> <span data-ttu-id="bc598-106">Un processo può utilizzare la funzione [**GetStdHandle**](getstdhandle.md), [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858)o [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) per aprire uno di questi handle.</span><span class="sxs-lookup"><span data-stu-id="bc598-106">A process can use the [**GetStdHandle**](getstdhandle.md), [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858), or [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function to open one of these handles.</span></span>

<span data-ttu-id="bc598-107">La funzione [**GetStdHandle**](getstdhandle.md) fornisce un meccanismo per il recupero dell'input standard ( `STDIN` ), dell'output standard ( `STDOUT` ) e degli handle di errore standard ( `STDERR` ) associati a un processo.</span><span class="sxs-lookup"><span data-stu-id="bc598-107">The [**GetStdHandle**](getstdhandle.md) function provides a mechanism for retrieving the standard input (`STDIN`), standard output (`STDOUT`), and standard error (`STDERR`) handles associated with a process.</span></span> <span data-ttu-id="bc598-108">Durante la creazione della console, il sistema crea questi handle.</span><span class="sxs-lookup"><span data-stu-id="bc598-108">During console creation, the system creates these handles.</span></span> <span data-ttu-id="bc598-109">Inizialmente, `STDIN` è un handle per il buffer di input della console e `STDOUT` e `STDERR` sono handle del buffer dello schermo attivo della console.</span><span class="sxs-lookup"><span data-stu-id="bc598-109">Initially, `STDIN` is a handle to the console's input buffer, and `STDOUT` and `STDERR` are handles of the console's active screen buffer.</span></span> <span data-ttu-id="bc598-110">Tuttavia, la funzione [**SetStdHandle**](setstdhandle.md) può reindirizzare gli handle standard modificando l'handle associato a `STDIN` , `STDOUT` o `STDERR` .</span><span class="sxs-lookup"><span data-stu-id="bc598-110">However, the [**SetStdHandle**](setstdhandle.md) function can redirect the standard handles by changing the handle associated with `STDIN`, `STDOUT`, or `STDERR`.</span></span> <span data-ttu-id="bc598-111">Poiché gli handle standard del padre vengono ereditati da qualsiasi processo figlio, le chiamate successive a **GetStdHandle** restituiscono l'handle reindirizzato.</span><span class="sxs-lookup"><span data-stu-id="bc598-111">Because the parent's standard handles are inherited by any child process, subsequent calls to **GetStdHandle** return the redirected handle.</span></span> <span data-ttu-id="bc598-112">Un handle restituito da **GetStdHandle** può, pertanto, fare riferimento a un elemento diverso da I/O della console.</span><span class="sxs-lookup"><span data-stu-id="bc598-112">A handle returned by **GetStdHandle** may, therefore, refer to something other than console I/O.</span></span> <span data-ttu-id="bc598-113">Prima di creare un processo figlio, ad esempio, un processo padre può usare **SetStdHandle** per impostare un handle di pipe come `STDIN` handle ereditato dal processo figlio.</span><span class="sxs-lookup"><span data-stu-id="bc598-113">For example, before creating a child process, a parent process can use **SetStdHandle** to set a pipe handle to be the `STDIN` handle that is inherited by the child process.</span></span> <span data-ttu-id="bc598-114">Quando il processo figlio chiama **GetStdHandle**, ottiene l'handle della pipe.</span><span class="sxs-lookup"><span data-stu-id="bc598-114">When the child process calls **GetStdHandle**, it gets the pipe handle.</span></span> <span data-ttu-id="bc598-115">Questo significa che il processo padre può controllare gli handle standard del processo figlio.</span><span class="sxs-lookup"><span data-stu-id="bc598-115">This means that the parent process can control the standard handles of the child process.</span></span> <span data-ttu-id="bc598-116">Gli handle restituiti da **GetStdHandle** hanno `GENERIC_READ | GENERIC_WRITE` accesso a meno che non sia stato usato **SetStdHandle** per impostare l'handle standard in modo che disponga di un accesso minore.</span><span class="sxs-lookup"><span data-stu-id="bc598-116">The handles returned by **GetStdHandle** have `GENERIC_READ | GENERIC_WRITE` access unless **SetStdHandle** has been used to set the standard handle to have lesser access.</span></span>

<span data-ttu-id="bc598-117">Il valore degli handle restituiti da [**GetStdHandle**](getstdhandle.md) non è 0, 1 e 2, pertanto le costanti di flusso predefinite standard in stdio. h ( `STDIN` , `STDOUT` e `STDERR` ) non possono essere usate in funzioni che richiedono un handle della console.</span><span class="sxs-lookup"><span data-stu-id="bc598-117">The value of the handles returned by [**GetStdHandle**](getstdhandle.md) are not 0, 1, and 2, so the standard predefined stream constants in Stdio.h (`STDIN`, `STDOUT`, and `STDERR`) cannot be used in functions that require a console handle.</span></span>

<span data-ttu-id="bc598-118">La funzione [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) consente a un processo di ottenere un handle per il buffer di input della console e il buffer dello schermo attivo, anche se `STDIN` e `STDOUT` sono stati reindirizzati.</span><span class="sxs-lookup"><span data-stu-id="bc598-118">The [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) function enables a process to get a handle to its console's input buffer and active screen buffer, even if `STDIN` and `STDOUT` have been redirected.</span></span> <span data-ttu-id="bc598-119">Per aprire un handle per il buffer di input di una console, specificare il `CONIN$` valore in una chiamata a **CreateFile**.</span><span class="sxs-lookup"><span data-stu-id="bc598-119">To open a handle to a console's input buffer, specify the `CONIN$` value in a call to **CreateFile**.</span></span> <span data-ttu-id="bc598-120">Specificare il `CONOUT$` valore in una chiamata a **CreateFile** per aprire un handle per il buffer dello schermo attivo di una console.</span><span class="sxs-lookup"><span data-stu-id="bc598-120">Specify the `CONOUT$` value in a call to **CreateFile** to open a handle to a console's active screen buffer.</span></span> <span data-ttu-id="bc598-121">**CreateFile** consente di specificare l'accesso in lettura/scrittura dell'handle restituito.</span><span class="sxs-lookup"><span data-stu-id="bc598-121">**CreateFile** enables you to specify the read/write access of the handle that it returns.</span></span>

<span data-ttu-id="bc598-122">La funzione [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) crea un nuovo buffer dello schermo e restituisce un handle.</span><span class="sxs-lookup"><span data-stu-id="bc598-122">The [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) function creates a new screen buffer and returns a handle.</span></span> <span data-ttu-id="bc598-123">Questo handle può essere usato in qualsiasi funzione che accetta un handle per l'output della console.</span><span class="sxs-lookup"><span data-stu-id="bc598-123">This handle can be used in any function that accepts a handle to console output.</span></span> <span data-ttu-id="bc598-124">Il nuovo buffer dello schermo non è attivo (visualizzato) finché non viene specificato il relativo handle in una chiamata alla funzione [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) .</span><span class="sxs-lookup"><span data-stu-id="bc598-124">The new screen buffer is not active (displayed) until its handle is specified in a call to the [**SetConsoleActiveScreenBuffer**](setconsoleactivescreenbuffer.md) function.</span></span> <span data-ttu-id="bc598-125">Si noti che la modifica del buffer dello schermo attivo non influisce sull'handle restituito da [**GetStdHandle**](getstdhandle.md).</span><span class="sxs-lookup"><span data-stu-id="bc598-125">Note that changing the active screen buffer does not affect the handle returned by [**GetStdHandle**](getstdhandle.md).</span></span> <span data-ttu-id="bc598-126">Analogamente, l'utilizzo di [**SetStdHandle**](setstdhandle.md) per modificare l' `STDOUT` handle non influisce sul buffer dello schermo attivo.</span><span class="sxs-lookup"><span data-stu-id="bc598-126">Similarly, using [**SetStdHandle**](setstdhandle.md) to change the `STDOUT` handle does not affect the active screen buffer.</span></span>

<span data-ttu-id="bc598-127">Gli handle della console restituiti da [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) e [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) possono essere usati in qualsiasi funzione console che richiede un handle per il buffer di input di una console o di un buffer dello schermo della console.</span><span class="sxs-lookup"><span data-stu-id="bc598-127">Console handles returned by [**CreateFile**](https://msdn.microsoft.com/library/windows/desktop/aa363858) and [**CreateConsoleScreenBuffer**](createconsolescreenbuffer.md) can be used in any of the console functions that require a handle to a console's input buffer or of a console screen buffer.</span></span> <span data-ttu-id="bc598-128">Gli handle restituiti da [**GetStdHandle**](getstdhandle.md) possono essere usati dalle funzioni della console se non sono stati reindirizzati per fare riferimento a elementi diversi dall'I/O della console.</span><span class="sxs-lookup"><span data-stu-id="bc598-128">Handles returned by [**GetStdHandle**](getstdhandle.md) can be used by the console functions if they have not been redirected to refer to something other than console I/O.</span></span> <span data-ttu-id="bc598-129">Se un handle standard è stato reindirizzato per fare riferimento a un file o a una pipe, tuttavia, l'handle può essere usato solo dalle funzioni [**ReadFile**](https://msdn.microsoft.com/library/windows/desktop/aa365467) e [**WriteFile**](https://msdn.microsoft.com/library/windows/desktop/aa365747) .</span><span class="sxs-lookup"><span data-stu-id="bc598-129">If a standard handle has been redirected to refer to a file or a pipe, however, the handle can only be used by the [**ReadFile**](https://msdn.microsoft.com/library/windows/desktop/aa365467) and [**WriteFile**](https://msdn.microsoft.com/library/windows/desktop/aa365747) functions.</span></span> <span data-ttu-id="bc598-130">[**FileType**](https://docs.microsoft.com/windows/win32/api/fileapi/nf-fileapi-getfiletype) può contribuire a determinare a quale tipo di dispositivo fa riferimento l'handle.</span><span class="sxs-lookup"><span data-stu-id="bc598-130">[**GetFileType**](https://docs.microsoft.com/windows/win32/api/fileapi/nf-fileapi-getfiletype) can assist in determining what device type the handle refers to.</span></span> <span data-ttu-id="bc598-131">Un handle della console presenta come `FILE_TYPE_CHAR` .</span><span class="sxs-lookup"><span data-stu-id="bc598-131">A console handle presents as `FILE_TYPE_CHAR`.</span></span>

<span data-ttu-id="bc598-132">Un processo può utilizzare la funzione [**DuplicateHandle**](https://msdn.microsoft.com/library/windows/desktop/ms724251) per creare un handle console duplicato con accesso o ereditarietà diversi dall'handle originale.</span><span class="sxs-lookup"><span data-stu-id="bc598-132">A process can use the [**DuplicateHandle**](https://msdn.microsoft.com/library/windows/desktop/ms724251) function to create a duplicate console handle that has different access or inheritability from the original handle.</span></span> <span data-ttu-id="bc598-133">Si noti, tuttavia, che un processo può creare un handle di console duplicato solo per uso personale.</span><span class="sxs-lookup"><span data-stu-id="bc598-133">Note, however, that a process can create a duplicate console handle only for its own use.</span></span> <span data-ttu-id="bc598-134">Questo comportamento è diverso da quello degli altri tipi di handle (ad esempio, file, pipe o oggetti mutex), per i quali **DuplicateHandle** può creare un duplicato valido per un processo diverso.</span><span class="sxs-lookup"><span data-stu-id="bc598-134">This differs from other handle types (such as file, pipe, or mutex objects), for which **DuplicateHandle** can create a duplicate that is valid for a different process.</span></span>
<span data-ttu-id="bc598-135">L'accesso a una console deve essere condiviso durante la [creazione](creation-of-a-console.md) dell'altro processo oppure può essere richiesto da un altro processo tramite il meccanismo [**AttachConsole**](attachconsole.md) .</span><span class="sxs-lookup"><span data-stu-id="bc598-135">Access to a console must be shared during [creation](creation-of-a-console.md) of the other process or may be requested by the other process through the [**AttachConsole**](attachconsole.md) mechanism.</span></span>

<span data-ttu-id="bc598-136">Per chiudere un handle di console, un processo può usare la funzione [**CloseHandle**](https://msdn.microsoft.com/library/windows/desktop/ms724211) .</span><span class="sxs-lookup"><span data-stu-id="bc598-136">To close a console handle, a process can use the [**CloseHandle**](https://msdn.microsoft.com/library/windows/desktop/ms724211) function.</span></span>
